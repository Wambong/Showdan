{% load static %}
{% load i18n %}

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>{% block title %}Showdan{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="icon"  href="{% static 'images/logo1.png' %}">
    <link rel="stylesheet" href="{% static 'css/app.css' %}">
</head>
<body class="bg-light">
<!-- Top-right language switcher (floating) -->
{% get_current_language as LANGUAGE_CODE %}
<div class="lang-float dropdown">
  <button class="btn btn-sm btn-dark lang-float-btn dropdown-toggle"
          type="button"
          data-bs-toggle="dropdown"
          aria-expanded="false"
          aria-label="Language">
    <i class="bi bi-globe2 me-2"></i>
    <span class="lang-code">{{ LANGUAGE_CODE|upper }}</span>
  </button>

  <div class="dropdown-menu dropdown-menu-end lang-float-menu p-2">
    <form action="{% url 'set_language' %}" method="post" class="m-0">
      {% csrf_token %}
      <input type="hidden" name="next" value="{{ request.get_full_path }}">

      <button type="submit" class="dropdown-item rounded-2 text-white"
              name="language" value="en">
        EN
      </button>
      <button type="submit" class="dropdown-item rounded-2 text-white"
              name="language" value="ru">
        RU
      </button>
      <button type="submit" class="dropdown-item rounded-2 text-white"
              name="language" value="es">
        ES
      </button>
      <button type="submit" class="dropdown-item rounded-2 text-white"
              name="language" value="uk">
        UA
      </button>
      <button type="submit" class="dropdown-item rounded-2 text-white"
              name="language" value="uz">
        UZ
      </button>
    </form>
  </div>
</div>


<nav class="app-bottom-nav" role="navigation" aria-label="Primary">
  <div class="app-bottom-nav-inner">

    <a class="app-tab {% if request.resolver_match.url_name == 'home' %}is-active{% endif %}"
       href="{% url 'home' %}">
      <span class="app-ico">
        <i class="bi bi-house"></i>
      </span>
      <span class="app-label">{% translate "Home" %}</span>
    </a>

    <a class="app-tab {% if request.resolver_match.url_name == 'calendar' %}is-active{% endif %}"
       href="{% url 'events:calendar' %}">
      <span class="app-ico">
        <i class="bi bi-calendar3"></i>
      </span>
      <span class="app-label">{% translate "Calendar" %}</span>
    </a>

    <a class="app-tab {% if request.resolver_match.url_name == 'offers_inbox' %}is-active{% endif %}"
       href="{% url 'events:offers_inbox' %}">
      <span class="app-ico">
        <i class="bi bi-chat-dots"></i>
      </span>
      <span class="app-label">{% translate "Chats" %}</span>
    </a>
    <a class="app-tab {% if request.resolver_match.url_name == 'list' %}is-active{% endif %}"
       href="{% url 'events:list' %}">
      <span class="app-ico">
        <i class="bi bi-calendar4-event"></i>
      </span>
      <span class="app-label">{% translate "events" %}</span>
    </a>


<a class="app-tab {% if request.resolver_match.url_name == 'news' %}is-active{% endif %}"
   href="{% url 'accounts:news' %}">
  <span class="app-ico position-relative">
    <i class="bi bi-newspaper"></i>

    <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
          style="font-size:10px; line-height:1; padding:4px 6px;">
      {{ news_unread_count|default:0 }}
    </span>
  </span>

  <span class="app-label">{% translate "News" %}</span>
</a>


    {% if request.user.is_authenticated %}
      <a class="app-tab app-tab-profile {% if 'dashboard' in request.path %}is-active{% endif %}"
         href="{% url 'accounts:dash_home' %}">
        <span class="app-ico app-ico-avatar">
          <img
            src="{{ request.user.profile_picture.url }}"
            alt="Avatar"
            onerror="this.style.display='none';"
          >
        </span>
        <span class="app-label">
          {{ request.user.first_name|default:"Profile" }}
        </span>
      </a>
    {% else %}
      <a class="app-tab {% if request.resolver_match.url_name == 'login' %}is-active{% endif %}"
         href="{% url 'accounts:login' %}">
        <span class="app-ico">
          <i class="bi bi-box-arrow-in-right"></i>
        </span>
        <span class="app-label">{% translate "Login" %}</span>
      </a>
    {% endif %}

  </div>
</nav>

<div class="container-fluid py-4">

  <!-- Flash messages -->
  {% if messages %}
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }} alert-dismissible fade show js-auto-dismiss" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
      </div>
    {% endfor %}
  {% endif %}

  {% block content %}{% endblock %}
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="{% static 'js/main.js' %}"></script>
<script src="https://unpkg.com/htmx.org@1.9.12"></script>

</body>
</html>
