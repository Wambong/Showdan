{% load i18n %}
<div class="dash-main-card">

  <div class="d-flex align-items-center justify-content-between mb-3">
    <div>
      <h3 class="text-white mb-0">{% translate "Your dashboard" %}</h3>
      <div class="text-white-50 small">{% translate "Your profile and quick actions" %}</div>
    </div>

    <!-- HTMX-friendly: loads into dash main card but still works normally -->
    <a class="btn btn-outline-light btn-sm"
       href="{% url 'accounts:dash_profile_edit' %}"
       hx-get="{% url 'accounts:dash_profile_edit' %}"
       hx-target="#dashMainCard"
       hx-swap="innerHTML"
       hx-push-url="true">
      {% translate "Edit" %}
    </a>
  </div>

  <!-- Profile Overview -->
  <div class="dash-profile-card mb-3">
    <div class="d-flex gap-3 align-items-center">
      <div class="dash-big-avatar">
        {% if u.profile_picture %}
          <img src="{{ u.profile_picture.url }}" alt="Profile picture">
        {% endif %}
      </div>

      <div class="flex-grow-1">
        <div class="text-white fw-bold" style="font-size:18px;">
          {{ u.first_name }} {{ u.last_name }}
        </div>

        <div class="text-white-50 small">
          {% translate "Account" %}: <span class="text-white">{{ u.account_type|default:"user"|title }}</span>
        </div>

        <div class="text-white-50 small mt-1">
          {% if u.currency %}
            {% translate "Currency" %}: <span class="text-white">{{ u.currency.code }} ({{ u.currency.sign }})</span>
          {% else %}
            Currency: <span class="text-white">{% translate "Not set" %}</span>
          {% endif %}
        </div>

        <div class="text-white-50 small mt-1">
          {% translate "Balance" %}:
          <span class="text-white fw-semibold">
            {% if u.currency %}{{ u.currency.sign }}{% endif %} {{ u.balance|default:"0" }}
          </span>
        </div>

        <!-- Extra fields -->
        <div class="text-white-50 small mt-2">
          {% translate "Email" %}: <span class="text-white">{{ u.email }}</span>
        </div>

        {% if u.phone %}
          <div class="text-white-50 small mt-1">
            {% translate "Phone" %}: <span class="text-white">{{ u.phone }}</span>
          </div>
        {% endif %}

        {% if u.nickname %}
          <div class="text-white-50 small mt-1">
            {% translate "Nickname" %}: <span class="text-white">{{ u.nickname }}</span>
          </div>
        {% endif %}

        {% if u.date_of_birth %}
          <div class="text-white-50 small mt-1">
            {% translate "Date of birth" %}: <span class="text-white">{{ u.date_of_birth }}</span>
          </div>
        {% endif %}

        {% if u.years_of_experience is not None %}
          <div class="text-white-50 small mt-1">
            {% translate "Experience" %}:
            <span class="text-white">
              {{ u.years_of_experience }} year{{ u.years_of_experience|pluralize }}
            </span>
          </div>
        {% endif %}
      </div>
    </div>

    {% if is_pro %}
      <hr style="border-color: rgba(255,255,255,0.08);">
      <div class="text-white-50 small mb-1">{% translate "Professions" %}</div>

      <div class="d-flex flex-wrap gap-2">
        {% for p in u.professions.all %}
          <span class="badge bg-light text-dark border">{{ p.name }}</span>
        {% empty %}
          <span class="text-white-50 small">{% translate "No professions selected" %}.</span>
        {% endfor %}
      </div>
    {% endif %}

    {% if u.about_me %}
      <hr style="border-color: rgba(255,255,255,0.08);">
      <div class="text-white-50 small mb-1">{% translate "About me" %}</div>
      <div class="text-white" style="white-space: pre-line;">{{ u.about_me }}</div>
    {% endif %}

    <hr style="border-color: rgba(255,255,255,0.08);">

    <div class="row g-3">
      <div class="col-12 col-md-6">
        <div class="text-white-50 small mb-1">{% translate "Communication languages" %}</div>
        {% if u.communication_languages.exists %}
          <div class="d-flex flex-wrap gap-2">
            {% for l in u.communication_languages.all %}
              <span class="badge bg-light text-dark border">{{ l.name }}</span>
            {% endfor %}
          </div>
        {% else %}
          <div class="text-white-50 small">{% translate "None selected" %}</div>
        {% endif %}
      </div>

      <div class="col-12 col-md-6">
        <div class="text-white-50 small mb-1">{% translate "Event languages" %}</div>
        {% if u.event_languages.exists %}
          <div class="d-flex flex-wrap gap-2">
            {% for l in u.event_languages.all %}
              <span class="badge bg-light text-dark border">{{ l.name }}</span>
            {% endfor %}
          </div>
        {% else %}
          <div class="text-white-50 small">{% translate "None selected" %}</div>
        {% endif %}
      </div>
    </div>

    <hr style="border-color: rgba(255,255,255,0.08);">
    <div class="text-white-50 small mb-1">{% translate "Accepted event categories" %}</div>
    {% if u.accepted_event_categories.exists %}
      <div class="d-flex flex-wrap gap-2">
        {% for c in u.accepted_event_categories.all %}
          <span class="badge bg-light text-dark border">{{ c }}</span>
        {% endfor %}
      </div>
    {% else %}
      <div class="text-white-50 small">{% translate "No accepted categories selected." %}</div>
    {% endif %}

    <hr style="border-color: rgba(255,255,255,0.08);">
    <div class="text-white-50 small mb-2">{% translate "Pricing" %}</div>
    {% if u.currency %}
      <div class="row g-3">
        <div class="col-12 col-md-6">
          <div class="text-white-50 small">{% translate "Cost per hour" %}</div>
          <div class="text-white fw-semibold">
            {{ u.currency.sign }}{{ u.cost_per_hour|default:"—" }}
          </div>
        </div>
        <div class="col-12 col-md-6">
          <div class="text-white-50 small">{% translate "Cost per 5 hours" %}</div>
          <div class="text-white fw-semibold">
            {{ u.currency.sign }}{{ u.cost_per_5_hours|default:"—" }}
          </div>
        </div>
      </div>
    {% else %}
      <div class="text-white-50 small">{% translate "Pricing has not been set" %}.</div>
    {% endif %}
  </div>

  <!-- Quick Actions -->
  <div class="dash-main-grid mb-4">
    <a class="dash-tile" href="{% url 'events:calendar' %}">
      <div class="dash-tile-title">{% translate "Calendar" %}</div>
      <div class="dash-tile-sub">{% translate "Busy days, bookings, availability" %}</div>
    </a>

    <a class="dash-tile" href="{% url 'events:offers_inbox' %}">
      <div class="dash-tile-title">{% translate "Offers" %}</div>
      <div class="dash-tile-sub">{% translate "Chats and booking requests" %}</div>
    </a>

    <a class="dash-tile" href="{% url 'events:list' %}">
      <div class="dash-tile-title">{% translate "Events" %}</div>
      <div class="dash-tile-sub">{% translate "Browse posted events" %}</div>
    </a>

<a class="dash-tile"
   href="{% url 'accounts:favorites' %}"
   hx-get="{% url 'accounts:favorites' %}"
   hx-target="#dashMainCard"
   hx-swap="innerHTML"
   hx-push-url="true">
  <div class="dash-tile-title">{% translate "Favorites" %}</div>
  <div class="dash-tile-sub">{% translate "Saved profiles and events" %}</div>
</a>

  </div>

  <!-- ==========================================================
       FULL MEDIA SECTIONS (Professional photos / Normal / Audio / Video)
       Uses either reverse relations on u OR querysets passed from view
  =========================================================== -->

<!-- Professional photos -->
  <hr class="my-4">
<div id="dashMedia-professional" class="mb-4">
  {% include "accounts/dash_pages/partials/media_section.html" with cfg=media_cfg_professional items=professional_photos %}
</div>

<hr class="my-4">

<!-- Normal photos -->
<div id="dashMedia-normal" class="mb-4">
  {% include "accounts/dash_pages/partials/media_section.html" with cfg=media_cfg_normal items=normal_photos %}
</div>

<hr class="my-4">

<!-- Audio -->
<div id="dashMedia-audio" class="mb-4">
  {% include "accounts/dash_pages/partials/media_section.html" with cfg=media_cfg_audio items=audio_covers %}
</div>

<hr class="my-4">

<!-- Video -->
<div id="dashMedia-video" class="mb-0">
  {% include "accounts/dash_pages/partials/media_section.html" with cfg=media_cfg_video items=video_covers %}
</div>

</div>
