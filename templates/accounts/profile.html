{% extends "base.html" %}
{% load i18n %}
{% block title %}Profile | Showdan{% endblock %}

{% block content %}
<div class="card shadow-sm">
  <div class="card-body">

    <!-- ================= PROFILE HEADER ================= -->
<div class="d-flex align-items-start gap-3 mb-4">
  <img
    src="{{ request.user.profile_picture.url }}"
    class="rounded-circle border"
    width="88"
    height="88"
    alt="Profile picture"
  >

  <div class="flex-grow-1">
    <h4 class="mb-1">
      {{ request.user.first_name }} {{ request.user.last_name }}
    </h4>

    <div class="text-white-50 small">
      <div>{{ request.user.email }}</div>
      {% if request.user.date_of_birth %}
        <div>Date of birth: {{ request.user.date_of_birth }}</div>
      {% endif %}
    </div>

    {% if request.user.account_type == "professional" %}
      <div class="mt-2">
        <span class="badge bg-primary me-2">{% translate "Professional" %}</span>
      </div>
    {% endif %}
  </div>
</div>

<!-- ================= PROFESSIONAL DETAILS ================= -->
{% if request.user.account_type == "professional" %}
  <div class="mb-4">
    <h6 class="text-uppercase text-white-50 mb-2">{% translate "Professions" %}</h6>

    {% if request.user.professions.exists %}
      <ul class="list-inline mb-0">
        {% for p in request.user.professions.all %}
          <li class="list-inline-item">
            <span class="badge bg-light text-dark border">
              {{ p }}
            </span>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="text-white-50 mb-0">{% translate "No professions selected" %}</p>
    {% endif %}
  </div>
{% endif %}

<!-- ================= EXPERIENCE ================= -->
<div class="mb-4">
  <h6 class="text-uppercase text-white-50 mb-2">{% translate "Experience" %}</h6>
  <p class="mb-0">
    <strong>{{ request.user.years_of_experience }}</strong>
    {% translate "year" %}{{ request.user.years_of_experience|pluralize }} {% translate "of experience" %}
  </p>
</div>

<hr class="my-4">

<!-- ================= ABOUT ME ================= -->
<div class="mb-4">
  <h5 class="mb-2">{% translate "About me" %}</h5>

  {% if request.user.about_me %}
    <p class="text-white-50 mb-0" style="white-space: pre-line;">
      {{ request.user.about_me }}
    </p>
  {% else %}
    <p class="text-muted mb-0">{% translate "No description provided yet" %}.</p>
  {% endif %}
</div>

<hr class="my-4">

<!-- ================= LANGUAGES ================= -->
<div class="mb-4">
  <h5 class="mb-3">{% translate "Languages" %}</h5>

  <div class="mb-2">
    <div class="text-white-50 small mb-1">{% translate "Communication languages" %}</div>
    {% if request.user.communication_languages.exists %}
      {% for l in request.user.communication_languages.all %}
        <span class="badge bg-light text-dark border me-1 mb-1">
          {{ l.name }}
        </span>
      {% endfor %}
    {% else %}
      <span class="text-white-50">{% translate "None selected" %}</span>
    {% endif %}
  </div>

  <div>
    <div class="text-white-50 small mb-1">{% translate "Event languages" %}</div>
    {% if request.user.event_languages.exists %}
      {% for l in request.user.event_languages.all %}
        <span class="badge bg-light text-dark border me-1 mb-1">
          {{ l.name }}
        </span>
      {% endfor %}
    {% else %}
      <span class="text-white-50">{% translate "None selected" %}</span>
    {% endif %}
  </div>
</div>

<hr class="my-4">

<!-- ================= PRICING ================= -->
<div class="mb-0">
  <h5 class="mb-3">{% translate "Pricing" %}</h5>

  {% if request.user.currency %}
    <div class="row">
      <div class="col-sm-6 mb-2">
        <div class="text-white-50 small">{% translate "Cost per hour" %}</div>
        <div class="fs-5 fw-semibold">
          {{ request.user.currency.sign }}{{ request.user.cost_per_hour|default:"—" }}
        </div>
      </div>

      <div class="col-sm-6 mb-2">
        <div class="text-white-50 small">{% translate "Cost per 5 hours" %}</div>
        <div class="fs-5 fw-semibold">
          {{ request.user.currency.sign }}{{ request.user.cost_per_5_hours|default:"—" }}
        </div>
      </div>
    </div>
  {% else %}
    <p class="text-muted mb-0">{% translate "Pricing has not been set" %}.</p>
  {% endif %}
</div>


    <br>
    <div class="mb-3">
      <a class="btn btn-primary" href="{% url 'accounts:profile_edit' %}">{% translate "Edit Profile" %}</a>
    </div>

    <hr class="my-4">
    <h5 class="mb-2">{% translate "Accepted event categories" %}</h5>

    {% if request.user.accepted_event_categories.exists %}
      {% for c in request.user.accepted_event_categories.all %}
        <span class="badge bg-light text-dark border me-1 mb-1">{{ c }}</span>
      {% endfor %}
    {% else %}
      <p class="text-muted mb-0">{% translate "No accepted event categories selected" %}.</p>
    {% endif %}
   <hr class="my-4">
<h5 class="mb-3">{% translate "Professional picture</h5>
{% if request.user.professional_photos.exists %}
  <div class="row g-3">
    {% for photo in request.user.professional_photos.all %}
      <div class="col-6 col-md-4 col-lg-3">
        <img src="{{ photo.image.url }}" class="img-fluid rounded border" alt="Professional photo">
      </div>
    {% endfor %}
  </div>
{% else %}
  <div class="alert alert-light border d-flex align-items-center justify-content-between">
    <span class="text-muted mb-0">
      {% translate "No professional photos uploaded yet" %}.
    </span>
    <a href="{% url 'accounts:profile_edit' %}" class="btn btn-sm btn-primary">
      {% translate "Add professional photo" %}
    </a>
  </div>
{% endif %}

    <hr class="my-4">

    <h5 class="mb-3">{% translate "Normal pictures" %}</h5>
    {% if request.user.normal_photos.exists %}
    <div class="row g-3">
      {% for photo in request.user.normal_photos.all %}
        <div class="col-6 col-md-4 col-lg-3">
          <img src="{{ photo.image.url }}" class="img-fluid rounded border" alt="Photo">
        </div>
      {% endfor %}
    </div>
      {% else %}
        <div class="alert alert-light border d-flex align-items-center justify-content-between">
          <span class="text-muted mb-0">
            {% translate "No Normal photos uploaded yet" %}.
          </span>
          <a href="{% url 'accounts:profile_edit' %}" class="btn btn-sm btn-primary">
            {% translate "Add Normal photo" %}
          </a>
        </div>
      {% endif %}

  <hr class="my-4">
<h5 class="mb-3">{% translate "Audio Acapella Covers" %}</h5>

{% if request.user.audio_acapella_covers.exists %}
  <div class="list-group">
    {% for a in request.user.audio_acapella_covers.all %}
      <div class="list-group-item">
        <div class="d-flex justify-content-between align-items-center">
          <div class="fw-semibold">{{ a.title|default:"Audio cover" }}</div>
          <small class="text-muted">{{ a.uploaded_at }}</small>
        </div>
        <audio controls class="w-100 mt-2">
          <source src="{{ a.audio_file.url }}">
          {% translate "Your browser does not support the audio element" %}.
        </audio>
      </div>
    {% endfor %}
  </div>
{% else %}
  <div class="alert alert-light border d-flex align-items-center justify-content-between">
    <span class="text-muted mb-0">{% translate "No audio covers uploaded yet" %}.</span>
    <a href="{% url 'accounts:profile_edit' %}" class="btn btn-sm btn-primary">{% translate "Add audio cover" %}</a>
  </div>
{% endif %}



    <hr class="my-4">
<h5 class="mb-3">{% translate "Video Acapella Covers" %}</h5>
{% if request.user.video_acapella_covers.exists %}
  <div class="row g-3">
    {% for v in request.user.video_acapella_covers.all %}
      <div class="col-12 col-md-6">
        <div class="card shadow-sm">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div class="fw-semibold">{{ v.title|default:"Video cover" }}</div>
              <small class="text-muted">{{ v.uploaded_at }}</small>
            </div>
            <video controls class="w-100 mt-2" style="max-height: 360px;">
              <source src="{{ v.video_file.url }}">
              {% translate "Your browser does not support the video tag" %}.
            </video>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <div class="alert alert-light border d-flex align-items-center justify-content-between">
    <span class="text-muted mb-0">{% translate "No video covers uploaded yet" %}.</span>
    <a href="{% url 'accounts:profile_edit' %}" class="btn btn-sm btn-primary">{% translate "Add video cover" %}</a>
  </div>
{% endif %}

  </div>
</div>
{% endblock %}
